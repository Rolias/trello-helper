<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: TrelloGet.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: TrelloGet.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const TrelloBase = require('./TrelloBase')
const tv = require('./typeValidate')

class TrelloGet extends TrelloBase {
  constructor(pathString) {
    super(pathString)
  }

  /**
   * 
   * @param {tv.listOrBoardType} param 
   * @param {string} idType listId or boardId 
   */
  static validateIdAndOptions(param, idType) {
    tv.validate({obj: param, reqKeys: [idType, 'options']})
  }

  /**
 * Avoid repeating the common code where we need to first
 * validate the parameters
 * then extract the id
 * then make a call to get the command with the id
 * then go the get
 * @param {tv.listOrBoardType} param   
 * @param {string} idType 'listId' or 'boardId' 
 * @param {*} commandFunc a function(id) that returns a command string
 */
  getCardsRecipe(param, idType, commandFunc) {
    TrelloGet.validateIdAndOptions(param, idType)
    const {options} = param
    const id = param[idType]
    const path = commandFunc(id)
    return this.get({path, options})
  }

  /**
 * @param {Object} cardParam the id and options for the card
 * @param {string} cardParam.cardId
 * @param {object} cardParam.options
 */
  getCard(cardParam) {
    tv.validate({obj: cardParam, reqKeys: ['cardId', 'options']})
    const {cardId, options} = cardParam
    const path = TrelloBase.getBoardPrefixWithId(cardId)
    return this.get({path, options})
  }

  /** Get the actions on the card. Filter by tye action type if desired
   * defaults to 'all' for all action types see
   * https://developers.trello.com/reference/#action-types
   * @param {object} param
   * @param {string} param.cardId
   * @param {object} param.options
   * @returns {Promise&lt;Array.&lt;Object&lt;string,any>>>}
   */
  getActionsOnCard(param) {
    tv.validate({obj: param, reqKeys: ['cardId', 'options']})
    const {cardId, options} = param
    const path = `${TrelloBase.getCardPrefixWithId(cardId)}/actions`
    options.filter = options.filter || 'all'
    options.limit = options.limit || 1000
    return this.get({path, options})
  }

  // ========================= Custom Field Setters/Getters =====================  
  /**
   * Get the array of custom field items on the card.
   * @param {object} param 
   * @param {string} param.cardId
   * @returns {Promise&lt;Array&lt;object>>}
   */
  getCustomFieldItemsOnCard(param) {
    const path = `${TrelloBase.getCardPrefixWithId(param.cardId)}/customFieldItems`
    return this.get({path, options: {}})
  }

  /**
   * Get all cards on the passed list
   * @param {object} param  
   * @param {string} param.listId 
   * @param {object} param.options
   * @returns {Promise&lt;Array&lt;Object&lt;string,any>>>} a Promise of an array of card objects
   * @example getCardsOnListWith({listId:'123',options:{customFieldItems:true}})
   */
  getCardsOnList(param) {
    return this.getCardsRecipe(param, 'listId', TrelloBase.getListCardCmd)
  }


  /**
   * Get all the cards on the board. Two useful options are
   * limit:x to limit the number of cards (1 to 1000) coming back and
   * fields:'name,desc'
   * @param {object} param 
   * @param {string} param.boardId
   * @param {object} param.options
   * @returns {Promise&lt;Array&lt;Object&lt;string,any>>>} a Promise of an array of card objects
   */
  getCardsOnBoard(param) {
    return this.getCardsRecipe(param, 'boardId', TrelloBase.getCardsOnBoardWithId)
  }

  /**
   * Calls to retrieve archived cards from lists or boards use the same "recipe"
   * i.e. series of steps in a particular sequence. This recipe executes those
   * calls
   * @param {tv.listOrBoardType} param can have any other additional properties 
   * @param {string} idType  only expecting 'listId' and 'boardId'
   * @param {*} func 
   */
  async getArchivedCardsRecipe(param, idType, func) {
    tv.validateOptions(param)
    const options = this.addFilterClosedToOptions(param.options)
    param.options = options
    return await this.getCardsRecipe(param, idType, func)
  }

  /**
   * Get all cards that are archived for the passed List
   * @param {object} param 
   * @param {string} param.listId
   * @param {object} param.options
   * @returns {Promise&lt;Array.&lt;Object>>} returns Promise to array of cards
   * @example getArchivedCards({boardId:'123',listId'456'})
  */
  async getArchivedCardsOnList(param) {
    return await this.getArchivedCardsRecipe(param, 'listId', TrelloBase.getListCardCmd)
  }

  /**
 * Get all cards that are archived for the board
 * @param {{boardId:string, options:object}} param 
 * @returns {Promise&lt;Array.&lt;Object>>} returns Promise to array of cards
 * @example getArchivedCards({boardId:'123',listId'456'})
 */
  async getArchivedCardsOnBoard(param) {
    return await this.getArchivedCardsRecipe(param, 'boardId', TrelloBase.getCardsOnBoardWithId)
  }

  addFilterClosedToOptions(options) {
    return {...options, filter: 'closed'}
  }

  /**
   * Find the boardId for the given listID
   * @param {object} param 
   * @param {string} param.listId
   */
  async getBoardIdFromListId(param) {
    tv.validate({obj: param, reqKeys: ['listId']})
    const {listId} = param
    const path = `${TrelloBase.getListPrefixWithId(listId)}/board`
    return await this.get({path, options: {fields: 'id'}})
  }

  /**
   * Get all the members on the passed board
   * @param {object} param 
   * @param {string} param.boardId
   * @returns {Promise&lt;Array&lt;{id:string, fullName:string, username:string}>>}
   */
  getMembersOnBoard(param) {
    tv.validate({obj: param, reqKeys: ['boardId']})
    const {boardId} = param
    const path = `${TrelloBase.getBoardPrefixWithId(boardId)}/members`
    return this.get({path, options: {}})
  }

}

module.exports = TrelloGet</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-src_typeValidate.html">src/typeValidate</a></li><li><a href="module-trello.html">trello</a></li></ul><h3>Classes</h3><ul><li><a href="module-trello-Trello.html">Trello</a></li><li><a href="TrelloRequest.html">TrelloRequest</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Apr 21 2019 17:43:24 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
